const fs = require("fs"); const { Document, Packer, Paragraph, TextRun, HeadingLevel } = require("docx"); const scrapedData = JSON.parse(fs.readFileSync("scraped-data-with-images.json", "utf8")); async function createWordDocument() { const doc = new Document({ sections: [{ properties: {}, children: [ new Paragraph({ text: "Flex HRM - Komplett Dokumentation", heading: HeadingLevel.TITLE }), new Paragraph({ text: "133 sidor • 46,787 ord • 215 bilder", heading: HeadingLevel.HEADING_2 }), new Paragraph({ text: "" }), ...scrapedData.pages.flatMap(page => [ new Paragraph({ text: page.title, heading: HeadingLevel.HEADING_1 }), new Paragraph({ text: page.breadcrumbs || "", heading: HeadingLevel.HEADING_2 }), ...page.content.split("\n").filter(line => line.trim()).map(line => new Paragraph({ children: [new TextRun({ text: line.trim() })] })), new Paragraph({ text: "" }) ]) ] }] }); const buffer = await Packer.toBuffer(doc); fs.writeFileSync("flex-hrm-word-document.docx", buffer); console.log("Word document created!"); } createWordDocument().catch(console.error);
