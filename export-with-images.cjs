const fs = require("fs"); console.log("ðŸš€ Skapar komplett export med bilder..."); const data = JSON.parse(fs.readFileSync("./scraped-data-with-images.json", "utf8")); console.log("ðŸ“„ Laddat", data.pages.length, "sidor med", data.metadata.totalImages, "bilder");
let html = "<!DOCTYPE html><html><head><meta charset=\"UTF-8\"><title>Flex HRM Dokumentation</title><style>body{font-family:Arial,sans-serif;line-height:1.6;max-width:800px;margin:0 auto;padding:20px;}h1{color:#2c3e50;border-bottom:2px solid #3498db;}h2{color:#34495e;margin-top:30px;}img{max-width:100%;margin:15px 0;border:1px solid #ddd;border-radius:4px;}</style></head><body><h1>Flex HRM Dokumentation</h1><p><strong>Komplett dokumentation med bilder</strong></p><p>Totalt: " + data.pages.length + " sidor med " + data.metadata.totalImages + " bilder</p>";
for (let i = 0; i < data.pages.length; i++) { const page = data.pages[i]; if (i % 20 === 0) console.log("ðŸ“ Sida", i + 1); html += "<h2>" + page.title + "</h2>"; if (page.breadcrumbs) html += "<p><em>" + page.breadcrumbs + "</em></p>"; const paragraphs = page.content.split("\n").filter(p => p.trim()); for (const p of paragraphs) { if (p.trim()) html += "<p>" + p.trim() + "</p>"; } if (page.images) { for (const img of page.images) { const imgPath = "./extracted-images/" + img.filename; if (fs.existsSync(imgPath)) { try { const imgBuffer = fs.readFileSync(imgPath); const base64 = imgBuffer.toString("base64"); const mimeType = img.filename.endsWith(".png") ? "image/png" : "image/jpeg"; html += "<img src=\"data:" + mimeType + ";base64," + base64 + "\" alt=\"Bild\" />"; } catch (e) {} } } } }
html += "</body></html>"; const fileName = "flex-hrm-med-bilder-" + new Date().toISOString().split("T")[0] + ".html"; fs.writeFileSync(fileName, html); console.log("âœ… Komplett HTML med bilder skapat:", fileName); console.log("ðŸ“Š Storlek:", (html.length / 1024 / 1024).toFixed(2), "MB"); console.log("ðŸ“‹ Ã–ppna HTML-filen i webblÃ¤sare, kopiera allt (Ctrl+A, Ctrl+C), klistra in i Google Docs eller Word");
